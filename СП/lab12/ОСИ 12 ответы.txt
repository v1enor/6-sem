1. Что такое COM? COM-программирование?
Common Object Model. COM – модель программного обеспечения. Модель разработана Microsoft. 
Может применяться во всех операционных системах, но прижилась только в Windows.

COM-программирование: разработка программного обеспечения, имеющего модель COM.

2. Что такое COM-объект(компонент)? CLSID?
3. COM-объект: специализированный объект времени исполнения (экземпляр). 
CLSID - это идентификатор COM-компонента

3. Что такое GUID? Где применяется GUID? Размер GUID-идентификатора?
GUID - тип данных размером 128 бит, который используется для идентификации com-компонета или com-интерфейса

4. Какие типы COM-контейнеров бывают?
exe и dll

5. Что является клиентом и сервером в COM?
сервер - это программный модуль, который реализует COM-компоненты
клиент - это программный модуль, который создает экземпляры com-компонентов и использует их
*в качестве COM-клиента может выступать COM-сервер.  

6. Поясните понятия «однокомпонентный» и «многокомпонентный» COM-сервер. 
com-сервер называется "однокомпонентым" если состоит из одного пользовательского компонента помимо стандартного компонента, который реализует интерфейс IClassFactory
"многокомпонентный" сервер состоит из нескольких пользовательских компонентов

7. Поясните типы COM-серверов: CLSCTX_INPROC_SERVER, CLSCTX_LOCAL_SERVER, СLSCTX_REMOTE_SERVER. 
CLSCTX_INPROC_SERVER - dll-сервер внутрипроцессовый
CLSCTX_LOCAL_SERVER - exe-сервер, который работает за пределами процесса, но на той же машине
СLSCTX_REMOTE_SERVER - exe-сервер, который работает на удаленной машине

8. Как называется имя библиотеки, обеспечивающей работу COM-приложений.   
OLE32

9. Поясните назначение типа и структуру HRESULT.  
HRESULT тип данных который хранит информацию о результате вызова функции компонента 
размер 32 бит
первый бит указывает на успешность выполнения функции
следующие 15 бит хранят информацию о типе ошибке
и последние 16 бит хранят специфическую информацию об ошибке

10. Что такое COM-интерфейс? 
COM-интерфейс представляет собой способ взаимодействия между компонентами в рамках архитектуры COM.

11. Чем характеризуется COM-интерфейс?
1)идентификатор, который имеет тип GUID, 2)методы, 3)свойства

12. Что значит «стандартный» COM-интерфейс?
"стандартный" com-интерфейс это интерфейс который описан в спецификации COM - все знают его IID

13. Назовите два стандартных COM-интерфейса.
IUnknown
IClassFactory

14. Перечислите методы интерфейса IUnknown и поясните их назначение. 
* QueryInterface (находит интерфейсы по IID)
* AddRef (инкрементирует счетчик ссылок на интерфейс)
* Release (декрементирует счетчик ссылок на интерфейс)

15. Что такое «фабрика классов» и для чего она нужна?
это компонент, реализующий интерфейс IClassFactory, который создает экземпляры пользовательских компонентов

16. Перечислите методы интерфейса IClassFactory и поясните их назначение.
* CreateInstance (возвращает экземляр пользовательского компонента)
* LockServer (запрещает разрушение экземпляра фабрики классов)

17. Что такое «счетчик ссылок на интерфейсы»? Для чего он нужен? Каким образом и когда этот счетчик увеличивается и уменьшается?
Данный механиз позволяет узнать когда можно удалить экземпляр компонента из памяти. 
AddRef - увеличивает
Release - уменьшает

18. Какое соглашение о вызове и возврате должен обеспечивать метод COM-объекта? Какие методы являются исключением?
Все методы компонента должны возвращать тип данных HRESULT 
(исключение AddRef и Release)

19. Что должен «знать» COM-клиент, чтобы использовать COM-объект?
CLSID компонента
определение и IID интерфейсов

20. Объясните в чем заключается процесс регистрации COM-объекта?   
Записать в реест путь к dll и его CLSID

21. Поясните назначение утилиты regsvr32 и принцип ее работы. 
регистрирует удаляет COM-сервер из реестра

22. Поясните назначение утилиты regedit.
позволяет просматривать и изменять реестр

23. Перечислите пять функций, которые экспортируются  COM/DLL-контейнером. Поясните назначение этих функций.   
DllRegisterServer - исп. regsvr32 для регистрации dll в реестре
DllUnregisterServer - исп. regsvr32 для удаления dll из реестра
DllInstall - исп. regsvr32 чтобы понять можно ли вызывать другие функции
DllGetClassObject - исп. OLE32 для получения компонента по CLSID
DllCanUnloadNow - исп. OLE32 чтобы узнать можно ли выгрузить dll

24. Назовите функцию COM-контейнера, которая вызывается OLE32 для получения указатель на фабрику классов.
DllGetClassObject

25. Назовите функцию фабрики классов, в которой создается объект компонента. 
CreateInstance

26. Поясните назначение «счетчика экземпляров компонент». Где этот счетчик увеличивается и где уменьшается?
Показывает количество активных компонентов
Изменяется в конструкторе/деструкторе компонента

27. Назовите условие, при котором объект компонента удаляется.
счетчик ссылок на интерфейс == 0 и счетчик экземпляров компонента == 0

28. Объясните на механизм блокировки COM-сервера (функция LockServer фабрики классов). 
lockServer(true) запрещает разрушение экземпляра фабрики классов
lockServer(false) разрешает


